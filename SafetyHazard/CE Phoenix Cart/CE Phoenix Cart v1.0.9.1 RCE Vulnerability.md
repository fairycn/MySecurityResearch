CE Phoenix Cart v1.0.9.1 RCE Vulnerability
# Code Download :
* github https://github.com/CE-PhoenixCart/PhoenixCart/
* `git clone https://github.com/CE-PhoenixCart/PhoenixCart/`
or
* https://codeload.github.com/CE-PhoenixCart/PhoenixCart/zip/refs/heads/master
# Description of Safety Hazards
If you have been granted administrative privileges to access the back-end pages, you can access the following administrative pages, which can be configured with logging functions, but there are some issues that lead to malicious exploitation.
get Web page: `admin/configuration.php?gID=10&cID=89&action=edit` Page Log Destination information corresponding to the corresponding value of the configuration_value parameter corresponding to the value of the unfiltered cause of the existence of an override vulnerability, you can modify any suffix, customize the path to save the page, you can override the save to the non-website directory, admin/configuration

`admin/configuration.php?gID=10&cID=90&action=edit` can be customized to write a sentence that leads to an RCE.

# version information:
![本地路径](./CE%20Phoenix%20Cart%20v1.0.9.1%20img/1.png "Version") 
Note: I don't know why the Release file for the corresponding version doesn't have the full code, and the requirement is to download the full project file (which may just be an update patch and not contain the full code)
# Reproduction:
As shown in the demo below, you can change the default log saving location and file name.

Here I am based on my purpose to build the environment and Web page leaks the absolute path information set to save the log file where the path, so that the generated logs are saved directly in the website with the directory
![本地路径](./CE%20Phoenix%20Cart%20v1.0.9.1%20img/2.png "Log DestInation") 

After that, directly through the page to modify the Log Date Format corresponding to the value of the content shown in the figure below, and change the Store Page Parse Time corresponding to the value of True has been turned on the logging function, and after refreshing the current page, you can generate the corresponding php file (shell.php )
![本地路径](./CE%20Phoenix%20Cart%20v1.0.9.1%20img/3.png "Log Date Format") 

Through the webshenll management tool [AntSword](https://github.com/AntSwordProject/), connect to the generated shell.php (the following figure demonstrates, here I am the local setup of the relevant environment corresponds to the domain information is modified host file but in fact, the local IP)
![本地路径](./CE%20Phoenix%20Cart%20v1.0.9.1%20img/4.png "AntSword") 

Security risk test with direct access to the root directory via AntSword
![本地路径](./CE%20Phoenix%20Cart%20v1.0.9.1%20img/5.png "Security") 
If you don't know how to test with AntSword, you can use Burp Surite or a similar tool.
![本地路径](./CE%20Phoenix%20Cart%20v1.0.9.1%20img/7.png "Burp Surite") 
# Code Audit
Modify the value to locate the relevant function point source code location through the Web page.
`/admin/configuration.php`
`https://github.com/CE-PhoenixCart/PhoenixCart/blob/master/admin/configuration.php`
![本地路径](./CE%20Phoenix%20Cart%20v1.0.9.1%20img/6.png "configuration.php") 
The configuration_value parameter comes from user input and is not properly filtered, leading to an RCE vulnerability in the diplomatic writing of a sentence to a customizable log file.